--creating a shared object-------

CREATE SHARE "PROJECT_GLADIATOR_SHARE" COMMENT='';
GRANT USAGE ON DATABASE "RETAIL_DB" TO SHARE "PROJECT_GLADIATOR_SHARE";
GRANT USAGE ON SCHEMA "RETAIL_DB"."RETAIL_SCHEMA" TO SHARE "PROJECT_GLADIATOR_SHARE";
GRANT SELECT ON TABLE "RETAIL_DB"."RETAIL_SCHEMA"."CDC_ORDERS" TO SHARE "PROJECT_GLADIATOR_SHARE";
GRANT SELECT ON TABLE "RETAIL_DB"."RETAIL_SCHEMA"."CUSTOMER" TO SHARE "PROJECT_GLADIATOR_SHARE";
GRANT SELECT ON TABLE "RETAIL_DB"."RETAIL_SCHEMA"."LINEITEM" TO SHARE "PROJECT_GLADIATOR_SHARE";
GRANT SELECT ON TABLE "RETAIL_DB"."RETAIL_SCHEMA"."NATION" TO SHARE "PROJECT_GLADIATOR_SHARE";
GRANT SELECT ON TABLE "RETAIL_DB"."RETAIL_SCHEMA"."ORDERS" TO SHARE "PROJECT_GLADIATOR_SHARE";
GRANT SELECT ON TABLE "RETAIL_DB"."RETAIL_SCHEMA"."PART" TO SHARE "PROJECT_GLADIATOR_SHARE";
GRANT SELECT ON TABLE "RETAIL_DB"."RETAIL_SCHEMA"."PARTSUPP" TO SHARE "PROJECT_GLADIATOR_SHARE";
GRANT SELECT ON TABLE "RETAIL_DB"."RETAIL_SCHEMA"."REGION" TO SHARE "PROJECT_GLADIATOR_SHARE";
GRANT SELECT ON TABLE "RETAIL_DB"."RETAIL_SCHEMA"."SUPPLIER" TO SHARE "PROJECT_GLADIATOR_SHARE";
GRANT USAGE ON WAREHOUSE COMPUTE_WH TO ROLE ACCOUNTADMIN;

--creating a reader account------

CREATE MANAGED ACCOUNT READER_ACCT admin_name='NKREADER', admin_password='Nilesh@12345', type=reader, COMMENT='';

--now adding a reader------

ALTER SHARE "PROJECT_GLADIATOR_SHARE" ADD ACCOUNTS = KP50350;

--in the reader account-------

CREATE OR REPLACE WAREHOUSE PROJECT_SHARE_WH;

CREATE DATABASE "PROJECT_DB" FROM SHARE JHDYMZO.LV12578."PROJECT_GLADIATOR_SHARE";

GRANT IMPORTED PRIVILEGES ON DATABASE "PROJECT_DB" TO ROLE "ACCOUNTADMIN";
GRANT IMPORTED PRIVILEGES ON DATABASE "PROJECT_DB" TO ROLE "SECURITYADMIN";

SELECT * FROM "PROJECT_DB"."RETAIL_SCHEMA"."NATION" LIMIT 5;
